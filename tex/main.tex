\documentclass{report}

\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{enumitem}
\usepackage{framed}
\usepackage{mathpartir}
\usepackage{mathtools}
\usepackage{tabularx}
\usepackage{placeins}
\usepackage{stmaryrd}
\usepackage{centernot}
\usepackage{wrapfig}
\usepackage{hyperref}
\usepackage[numbers]{natbib}
\bibliographystyle{IEEEtranN}
\usepackage{fancyvrb}
\usepackage[override]{cmtt}
\usepackage{csvsimple}

\usepackage{epigraph}
\usepackage{colortbl}
\usepackage{xspace}
\usepackage{listings}
\usepackage{relsize}
\usepackage{booktabs}
\usepackage{graphbox}
\usepackage{fontawesome}

\input{darais-latex-imports}
\input{darais-latex-macros}
\input{figures}

\newcommand{\lang}{Allyn\xspace}
\newcommand{\mpc}{\ensuremath{\lambda_{\mathrm{MPC}}}\xspace}
\newcommand{\system}{\textsc{Symphony}\xspace}
\newcommand{\obliv}{\ensuremath{\lambda_{\mathrm{Obliv}}}\xspace}

\newcommand{\ins}[1]{\textcolor{red}{Ian: #1}}
\newcommand{\mwh}[1]{\textcolor{blue}{Mike: #1}}

\newcommand{\underbracketarg}[2]{\underbracket[0.5pt]{#2}_{#1}}
\newcommand{\code}[1]{\lstinline{#1}}
\newcommand{\mfootnotesize}[1]{\ifmmode\textnormal{\(#1\)}\else{#1}\fi}

\makeatletter
\lst@InstallFamily k{primitives}{primitivestyle}\slshape{primitivestyle}{}ld
\lst@InstallFamily k{basevalues}{basevaluestyle}\slshape{basevaluestyle}{}ld
\lst@InstallFamily k{operations}{operationstyle}\slshape{operationstyle}{}ld
\makeatother

\lstdefinestyle{customcaml}{
	numbers=left,
	belowcaptionskip=1\baselineskip,
	breaklines=true,
	tabsize=4,
	% frame=L,
	xleftmargin=\parindent,
	showstringspaces=false,
        basicstyle=\linespread{0.5}\footnotesize\sffamily,
	columns=flexible,
	otherkeywords={fix, mux, xor, with, region, castP, castS, flip, rnd, castU, castNU},
	literate={{<-}{{$\leftarrow\,$}}2
		{->}{{$\rightarrow\,$}}2},
	numberstyle=\tiny\rmfamily,
	keywordstyle=\bfseries\color{green!40!black},
	commentstyle=\itshape\color{purple!40!black},
	identifierstyle=\color{blue!80!black},
	stringstyle=\color{orange},
}

\lstset{language=Caml,style=customcaml}

\lstdefinelanguage{psl}{
  mathescape,
  frame=none,
  alsoletter=-,
  columns=fullflexible,
  keepspaces,
  literate={
   *{(}{{{\color{gray}{(}}}}1
    {)}{{{\color{gray}{)}}}}1
    {[}{{{\color{gray}{[}}}}1
    {]}{{{\color{gray}{]}}}}1
    {\{}{{{\color{gray}{\{}}}}1
    {\}}{{{\color{gray}{\}}}}}1
    {.}{{{\color{gray}{.}}}}1
    {:}{{{\color{gray}{:}}}}1
    {,}{{{\color{gray}{,}}}}1
    {;}{{{\color{gray}{;}}}}1
    {=}{{{\color{gray}{=}}}}1
    {|}{{{\color{gray}{|}}}}1
    {@}{{{\color{gray}{@}}}}1
    {\#}{{{\color{gray}{\#}}}}1
    {!}{{{\color{gray}{!}}}}1
    {\_}{{{\color{gray}{\_}}}}1
    %
    {+}{{{\color[RGB]{8,117,0}{+}}}}1
    {*}{{{\color[RGB]{8,117,0}{*}}}}1
    {/}{{{\color[RGB]{8,117,0}{/}}}}1
    {\%}{{{\color[RGB]{8,117,0}{\%}}}}1
    {<}{{{\color[RGB]{8,117,0}{<}}}}1
    {>}{{{\color[RGB]{8,117,0}{>}}}}1
    {\^}{{{\color[RGB]{8,117,0}{\^{}}}}}1
    %
    {=>}{{{\color{gray}{=>}}}}2
    {->}{{{\color{gray}{->}}}}2
    {<-}{{{\color{gray}{<-}}}}2
    {<<}{{{\color{gray}{<<}}}}2
    {>>}{{{\color{gray}{>>}}}}2
    {:=}{{{\color{gray}{:=}}}}2
    %
    {==}{{{\color[RGB]{8,117,0}{==}}}}2
    {<=}{{{\color[RGB]{8,117,0}{<=}}}}2
    {>=}{{{\color[RGB]{8,117,0}{>=}}}}2
    {><}{{{\color[RGB]{8,117,0}{><}}}}2
    {||}{{{\color[RGB]{8,117,0}{||}}}}2
    {&&}{{{\color[RGB]{8,117,0}{\&\&}}}}2
    {\\/}{{{\color[RGB]{8,117,0}{\textbackslash{}/}}}}2
    {/\\}{{{\color[RGB]{8,117,0}{/\textbackslash{}}}}}2
    {()}{{{\color[RGB]{8,117,0}{()}}}}2
    {[]}{{{\color[RGB]{8,117,0}{[]}}}}2
    {::}{{{\color[RGB]{8,117,0}{::}}}}2
    {++}{{{\color[RGB]{8,117,0}{++}}}}2
    {\{\}}{{{\color[RGB]{8,117,0}{\{\}}}}}2
    {\_|\_}{{{\color[RGB]{8,117,0}{\_|\_}}}}3
    %
    {0}{{{\color[RGB]{116,0,0}{0}}}}1
    {1}{{{\color[RGB]{116,0,0}{1}}}}1
    {2}{{{\color[RGB]{116,0,0}{2}}}}1
    {3}{{{\color[RGB]{116,0,0}{3}}}}1
    {4}{{{\color[RGB]{116,0,0}{4}}}}1
    {5}{{{\color[RGB]{116,0,0}{5}}}}1
    {6}{{{\color[RGB]{116,0,0}{6}}}}1
    {7}{{{\color[RGB]{116,0,0}{7}}}}1
    {8}{{{\color[RGB]{116,0,0}{8}}}}1
    {9}{{{\color[RGB]{116,0,0}{9}}}}1
    {p0}{{{p0}}}2
    {p1}{{{p1}}}2
    {p2}{{{p2}}}2
    {p3}{{{p3}}}2
    {p4}{{{p4}}}2
    {p5}{{{p5}}}2
    {p6}{{{p6}}}2
    {p7}{{{p7}}}2
    {p8}{{{p8}}}2
    {p9}{{{p9}}}2
    {0n}{{{\color[RGB]{116,0,0}{0n}}}}2
    {1n}{{{\color[RGB]{116,0,0}{1n}}}}2
    {2n}{{{\color[RGB]{116,0,0}{2n}}}}2
    {3n}{{{\color[RGB]{116,0,0}{3n}}}}2
    {4n}{{{\color[RGB]{116,0,0}{4n}}}}2
    {5n}{{{\color[RGB]{116,0,0}{5n}}}}2
    {6n}{{{\color[RGB]{116,0,0}{6n}}}}2
    {7n}{{{\color[RGB]{116,0,0}{7n}}}}2
    {8n}{{{\color[RGB]{116,0,0}{8n}}}}2
    {9n}{{{\color[RGB]{116,0,0}{9n}}}}2
    {-0}{{{\color[RGB]{116,0,0}{-0}}}}2
    {-1}{{{\color[RGB]{116,0,0}{-1}}}}2
    {-2}{{{\color[RGB]{116,0,0}{-2}}}}2
    {-3}{{{\color[RGB]{116,0,0}{-3}}}}2
    {-4}{{{\color[RGB]{116,0,0}{-4}}}}2
    {-5}{{{\color[RGB]{116,0,0}{-5}}}}2
    {-6}{{{\color[RGB]{116,0,0}{-6}}}}2
    {-7}{{{\color[RGB]{116,0,0}{-7}}}}2
    {-8}{{{\color[RGB]{116,0,0}{-8}}}}2
    {-9}{{{\color[RGB]{116,0,0}{-9}}}}2
    {-0n}{{{\color[RGB]{116,0,0}{-0n}}}}3
    {-1n}{{{\color[RGB]{116,0,0}{-1n}}}}3
    {-2n}{{{\color[RGB]{116,0,0}{-2n}}}}3
    {-3n}{{{\color[RGB]{116,0,0}{-3n}}}}3
    {-4n}{{{\color[RGB]{116,0,0}{-4n}}}}3
    {-5n}{{{\color[RGB]{116,0,0}{-5n}}}}3
    {-6n}{{{\color[RGB]{116,0,0}{-6n}}}}3
    {-7n}{{{\color[RGB]{116,0,0}{-7n}}}}3
    {-8n}{{{\color[RGB]{116,0,0}{-8n}}}}3
    {-9n}{{{\color[RGB]{116,0,0}{-9n}}}}3
    {0:}{{{\color[RGB]{184,184,184}{0:}}}}2
    {1:}{{{\color[RGB]{184,184,184}{1:}}}}2
    {2:}{{{\color[RGB]{184,184,184}{2:}}}}2
    {3:}{{{\color[RGB]{184,184,184}{3:}}}}2
    {4:}{{{\color[RGB]{184,184,184}{4:}}}}2
    {5:}{{{\color[RGB]{184,184,184}{5:}}}}2
    {6:}{{{\color[RGB]{184,184,184}{6:}}}}2
    {7:}{{{\color[RGB]{184,184,184}{7:}}}}2
    {8:}{{{\color[RGB]{184,184,184}{8:}}}}2
    {9:}{{{\color[RGB]{184,184,184}{9:}}}}2
    {10:}{{{\color[RGB]{184,184,184}{10:}}}}3
    {11:}{{{\color[RGB]{184,184,184}{11:}}}}3
    {12:}{{{\color[RGB]{184,184,184}{12:}}}}3
    {13:}{{{\color[RGB]{184,184,184}{13:}}}}3
    {14:}{{{\color[RGB]{184,184,184}{14:}}}}3
    {15:}{{{\color[RGB]{184,184,184}{15:}}}}3
    {16:}{{{\color[RGB]{184,184,184}{16:}}}}3
    {17:}{{{\color[RGB]{184,184,184}{17:}}}}3
    {18:}{{{\color[RGB]{184,184,184}{18:}}}}3
    {19:}{{{\color[RGB]{184,184,184}{19:}}}}3
    {0::}{{{\color[RGB]{116,0,0}{0}\color[RGB]{8,117,0}{::}}}}3
    {1::}{{{\color[RGB]{116,0,0}{1}\color[RGB]{8,117,0}{::}}}}3
    {2::}{{{\color[RGB]{116,0,0}{2}\color[RGB]{8,117,0}{::}}}}3
    {3::}{{{\color[RGB]{116,0,0}{3}\color[RGB]{8,117,0}{::}}}}3
    {4::}{{{\color[RGB]{116,0,0}{4}\color[RGB]{8,117,0}{::}}}}3
    {5::}{{{\color[RGB]{116,0,0}{5}\color[RGB]{8,117,0}{::}}}}3
    {6::}{{{\color[RGB]{116,0,0}{6}\color[RGB]{8,117,0}{::}}}}3
    {7::}{{{\color[RGB]{116,0,0}{7}\color[RGB]{8,117,0}{::}}}}3
    {8::}{{{\color[RGB]{116,0,0}{8}\color[RGB]{8,117,0}{::}}}}3
    {9::}{{{\color[RGB]{116,0,0}{9}\color[RGB]{8,117,0}{::}}}}3
    {10::}{{{\color[RGB]{116,0,0}{10}\color[RGB]{8,117,0}{::}}}}3
    {11::}{{{\color[RGB]{116,0,0}{11}\color[RGB]{8,117,0}{::}}}}3
    {12::}{{{\color[RGB]{116,0,0}{12}\color[RGB]{8,117,0}{::}}}}3
    {13::}{{{\color[RGB]{116,0,0}{13}\color[RGB]{8,117,0}{::}}}}3
    {14::}{{{\color[RGB]{116,0,0}{14}\color[RGB]{8,117,0}{::}}}}3
    {15::}{{{\color[RGB]{116,0,0}{15}\color[RGB]{8,117,0}{::}}}}3
    {16::}{{{\color[RGB]{116,0,0}{16}\color[RGB]{8,117,0}{::}}}}3
    {17::}{{{\color[RGB]{116,0,0}{17}\color[RGB]{8,117,0}{::}}}}3
    {18::}{{{\color[RGB]{116,0,0}{18}\color[RGB]{8,117,0}{::}}}}3
    {19::}{{{\color[RGB]{116,0,0}{19}\color[RGB]{8,117,0}{::}}}}3
  },
  morekeywords={
      primitive,principal,def,fun,abs,forall,let,in,
      if,mux,then,else,case,reveal,share,send,trace,
      set,this,solo,as,fold,on,par,ref,array,do,
      read,write,from,to,proc,return,loop,when,
      import,nizk-witness,nizk-commit,virtual,party,
      send-share,recv-share,reveal-send,reveal-recv,
      wire,sec,brec,sign,unsign,is-signed
  },
  moreprimitives={
    yao,gmw,bgw,bgv,spdz,auto,ssec,isec,bundle,type,
    prin,prins,empty,unit,bool,string,nat,int,flt,list,
    rand,rand-range,inp,rev,inf,all,nizk-test,nizk-verify
  },
  moreoperations={
    not,to_flt,abs_val,ceil,sqrt,size,L,R,-
  },
  morebasevalues={
    true,false
  },
  string=[b]",
  comment=[l]{--},
  morecomment=[n]{\{-}{-\}},
  basicstyle=\small\ttfamily,
  commentstyle=\color[RGB]{184,184,184}\slshape,
  stringstyle=\color[RGB]{116,0,0},
  keywordstyle=\color[RGB]{117,117,0}\bfseries,
  primitivestyle=\color[RGB]{0,4,117},
  basevaluestyle=\color[RGB]{116,0,0},
  operationstyle=\color[RGB]{8,117,0}
}

%%% Macros for MPC
\newcommand{\alice}{B⸨‹A›B⸩\xspace}
\newcommand{\bob}{C⸨‹B›C⸩\xspace}

\newcommand{\alices}[1]{B⸨#1⸤A⸥B⸩}
\newcommand{\bobs}[1]{C⸨#1⸤B⸥C⸩}

\newcommand{\aliceSec}{\alices{s}\xspace}
\newcommand{\bobSec}{\bobs{s}\xspace}

\newcommand{\aliceSh}[1]{\alices{⌊#1⌋}}
\newcommand{\bobSh}[1]{\bobs{⌊#1⌋}}

\newcommand{\opaque}{A⸨★A⸩\xspace}
%%%

%%% Macros from Symphony Paper
\newcommand{\eset}{⸨∅⸩}
%%%

\definecolor{implColor}{HTML}{EA9999}
\definecolor{theoryColor}{HTML}{A4C2F4}

\begin{document}

\title{\lang: A Probabilistically Oblivious Language for Secure Multiparty Computation}

\author{Ian Sweet \\
  \emph{University of Maryland, College Park} \\
  \emph{isweet@umd.edu}}

\date{}

\maketitle

\begin{abstract} \input{00-abstract.tex} \end{abstract}

\ins{TODO: Ensure consistency, eliminate staleness.} \\
\ins{TODO: Add all the citations, hunt for broken refs.} \\
\ins{TODO: Make sure code examples are consistent with langauges --- Figure 2.3 isn't, for example.}

\tableofcontents

\input{01-intro.tex}
\input{02-overview.tex}
\input{03-mpc.tex}
\input{04-obliv.tex}
\input{05-proposal.tex}
\input{06-open-problems.tex}

\bibliography{abbrev0,refs,crypto,crypto-obliv,ref,shared,custom,local}

\appendix

\input{07-gmw.tex}
\input{08-oram.tex}

\end{document}
