\newcommand\FigureMPCSyntax[2]{
\begin{figure}
\begingroup
\setlength\arraycolsep{0pt} % default is 6pt
\small
D⁅
\vspace*{-2ex}
M⁅
Aːrcrcl@{␠}l
A⁅ i     ⧼∈⧽ ℤ            ⧼ ⧽                                & «integers»
A⁃ A,B,C ⧼∈⧽ ‹party›      ⧼ ⧽                                & «parties»
A⁃ m,p,q ⧼∈⧽ ‹pset›       ⧼≜⧽ ℘(‹party›)                     & «sets of parties»
A⁃ x,y,z ⧼∈⧽ ‹var›        ⧼ ⧽                                & «variables»
A⁃ ⊙     ⧼∈⧽ ‹bop›        ⧼ ⧽                                & «binary ops (⸨+⸩{,} ⸨×⸩{,} ...)»
A⁃ a     ⧼∈⧽ ‹atom›       ⧼⩴⧽ x                             & «variable reference»
A⁃       ⧼ ⧽              ⧼¦⧽ i                              & «integer literal»
A⁃       ⧼ ⧽              ⧼¦⧽ p                              & «party set literal»
A⁃       ⧼ ⧽              ⧼¦⧽ x ⊙ x                          & «binary operation»
A⁃       ⧼ ⧽              ⧼¦⧽ x ¿ x ◇ x                      & «atomic conditional»
A⁃       ⧼ ⧽              ⧼¦⧽ ιᵢ␣x                           & «sum injection»
A⁃       ⧼ ⧽              ⧼¦⧽ ⟨x,x⟩                          & «pair creation»
A⁃       ⧼ ⧽              ⧼¦⧽ πᵢ␣x                           & «pair projection»
A⁃       ⧼ ⧽              ⧼¦⧽ λ⸤z⸥x⍪ e                       & «(rec.) function def»
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑ref⦒␣x                        & «reference creation»
A⁃       ⧼ ⧽              ⧼¦⧽ ¡x                             & «dereference»
A⁃       ⧼ ⧽              ⧼¦⧽ x ≔ x                          & «reference assignment»
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑read⦒                         & «read int input»
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑write⦒␣x                      & «write output»
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑share⦒[x→x]␣x                 & «share encrypted val.»
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑reveal⦒[x→x]␣x                & «reveal encrypted val.»
A⁃ e     ⧼∈⧽ ‹expr›       ⧼⩴⧽ a                              & «atomic expression»
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑case⦒␣x␣❴⇡-x.e❵❴⇡-x.e❵        & «elim for sums, psets»
A⁃       ⧼ ⧽              ⧼¦⧽ x␣x                            & «function call»
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑par⦒[x]␣e                     & «parallel execution»
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑let⦒␣x=e␣⦑in⦒␣e               & «let binding»
A⁆
M⁆
\vspace*{-2ex}
D⁆
\endgroup
\vspace*{-2ex}
\caption{#2}
\label{#1}
\vspace*{-2ex}
\end{figure}
}

\newcommand\FigureMPCSemanticsAux[2]{
\begin{figure}
\begingroup
\setlength\arraycolsep{0pt} % default is 6pt
\small
D⁅
\vspace*{-2ex}
M⁅
X⁅Aːrclcl@{␠}l
  A⁅ ℓ     ⧼∈⧽ ‹loc›         ⧼ ⧽                      & «memory locations»
  A⁃ ψ     ⧼∈⧽ ‹prot›        ⧼⩴⧽ ⋅                    & «cleartext»
  A⁃       ⧼ ⧽               ⧼¦⧽ ⦑enc⦒⋕m              & «encrypted»
  A⁃ γ     ⧼∈⧽ ‹env›         ⧼≜⧽ ‹var› ⇀ ‹value›      & «value environment»
  A⁃ δ     ⧼∈⧽ ‹store›       ⧼≜⧽ ‹loc› ⇀ ‹value›      & «value store»
  A⁃ u     ⧼∈⧽ ‹loc-value›   ⧼⩴⧽ i⸢ψ⸣                 & «integer/share value»
  A⁃       ⧼ ⧽               ⧼¦⧽ p                    & «party set value»
  A⁃       ⧼ ⧽               ⧼¦⧽ ιᵢ␣v                 & «tagged union injection»
  A⁃       ⧼ ⧽               ⧼¦⧽ ⟨v,v⟩                & «pairs»
  A⁃       ⧼ ⧽               ⧼¦⧽ ⟨λ⸤z⸥x⍪e,γ⟩          & «closures»
  A⁃       ⧼ ⧽               ⧼¦⧽ ℓ⸢⋕m⸣                 & «reference»
  A⁃ v     ⧼∈⧽ ‹value›       ⧼⩴⧽ u@m                  & «located value»
  A⁃       ⧼ ⧽               ⧼¦⧽ ★                    & «opaque value»
  A⁆
X⁃
X⁃⩊B⁅ ‗↙ₘ ∈ ‹loc-value› → ‹loc-value› ␣⨟␣ ‹value› → ‹value› B⁆
X⁃
X⁃ Aː[t]rclcl
   A⁅ i⸢ψ⸣        ⧼↙ₘ⧽ ⧼≜⧽ i ⸢ψ⸣
   A⁃ p           ⧼↙ₘ⧽ ⧼≜⧽ p
   A⁃ (ιᵢ␣v)      ⧼↙ₘ⧽ ⧼≜⧽ ιᵢ␣(v↙ₘ)
   A⁆
   ⩊
   Aː[t]rclcl
   A⁅ ⟨v₁,v₂⟩     ⧼↙ₘ⧽ ⧼≜⧽ ⟨v₁↙ₘ,v₂↙ₘ⟩
   A⁃ ⟨λ⸤z⸥x⍪e,γ⟩ ⧼↙ₘ⧽ ⧼≜⧽ ⟨λ⸤z⸥x⍪e,γ⟩
   A⁃ ℓ⸢⋕p⸣       ⧼↙ₘ⧽ ⧼≜⧽ ℓ⸢⋕p⸣
   A⁆
X⁃
X⁃(u@p)↙ₘ ≜ ‘❴Aːl@{␣}c@{␣}l
              A⁅ u↙⸤m⸥@(p∩m) & «if» & p ∩ m ≠ ∅
              A⁃ ★           & «if» & p ∩ m = ∅
              A⁆’.
  ⩊
  ★↙ₘ ≜ ★
X⁆
M⁆
\vspace*{-2ex}
D⁆
\endgroup
\vspace*{-2ex}
\caption{#2}
\label{#1}
\vspace*{-2ex}
\end{figure}
}

\newcommand\FigureMPCSemanticsSequential[2]{
\begin{figure*}
\begingroup
\setlength\arraycolsep{0pt} % default is 6pt
\def\MathparLineskip{\lineskip=6pt}
\small
D⁅
\vspace*{-2ex}
M⁅
X⁅ ⩊ κ ∈ ‹stack›  ⩴ ⊤ ¦ ⟨⦑let⦒␣x=□␣⦑in⦒␣e¦m,γ⟩∷κ
   ⩊ ς ∈ ‹config› ⩴ m,γ,δ,κ,e
   ⩊ ⩊
X⁆
M⁆
\hrule
\vspace*{0.5ex}
M⁅ X⁅ ⩊ B⁅ γ ⊢⸤m⸥ δ,a ↪ δ,v B⁆ X⁆
M⁆
\vspace*{-5ex}
P⁅ Rː⦗ST-Var⦘
   R⁅ -------------------------------------------
      γ ⊢⸤m⸥ δ,x ↪ δ,γ(x)↙⸤m⸥
   R⁆
P⁃ Rː⦗ST-Lit⦘
   R⁅ -------------------------------------------
      {Aːrclcl
       A⁅ γ ⧼⊢⸤m⸥⧽ δ,i ⧼↪⧽ δ,i@m
       A⁃ γ ⧼⊢⸤m⸥⧽ δ,p ⧼↪⧽ δ,p@m
       A⁆}
   R⁆
% P⁃ Rː⦗ST-Prin⦘
%    R⁅ -------------------------------------------
%       γ ⊢⸤m⸥ δ,p ↪ δ,p@m
%    R⁆
P⁃ Rː⦗ST-Int-Binop⦘
   R⁅{Aː[b]rcl
      A⁅ i₁⸢ψ⸣@m ⧼=⧽ γ(x₁)↙⸤m⸥
      A⁃ i₂⸢ψ⸣@m ⧼=⧽ γ(x₂)↙⸤m⸥
      A⁆}
   R⁃ ⊢⸤m⸥ ψ
      -------------------------------------------
      γ ⊢⸤m⸥ δ,x₁⊙x₂ ↪ δ,⟦⊙⟧(i₁,i₂)⸢ψ⸣@m
   R⁆
P⁃ Rː⦗ST-PSet-Binop⦘
   R⁅{Aː[b]rcl
      A⁅ p₁@m ⧼=⧽ γ(x₁)↙⸤m⸥
      A⁃ p₂@m ⧼=⧽ γ(x₂)↙⸤m⸥
      A⁆}
   % R⁃ v = {‘❴Aːl@{␠}l@{␠}l
   %           A⁅ ‹true›  & ⟪«if»⟫ & p₁ = p₂
   %           A⁃ ‹false› & ⟪«if»⟫ & p₁ ≠ p₂
   %           A⁆’.}
   % R⁃ {Aːl A⁅ \vphantom{p₁⸢ψ⸣@m = γ(x₁)↙⸤m⸥}
   %         A⁃ \vphantom{p₁⸢ψ⸣@m = γ(x₁)↙⸤m⸥} ⊢⸤m⸥ ψ
   %         A⁆}
      -------------------------------------------
      {Aːrclcl
       A⁅ γ ⧼⊢⸤m⸥⧽ δ,x₁∪x₂ ⧼↪⧽ δ,(p₁∪p₂)@m
       %A⁃ γ ⧼⊢⸤m⸥⧽ δ,x₁≡x₂ ⧼↪⧽ δ,v@m
       A⁆}
   R⁆
P⁃ Rː⦗ST-Mux⦘
   R⁅{Aː[b]rcl
      A⁅ i₁⸢ψ⸣@m ⧼=⧽ γ(x₁)↙⸤m⸥
      A⁃ i₂⸢ψ⸣@m ⧼=⧽ γ(x₂)↙⸤m⸥
      A⁃ i₃⸢ψ⸣@m ⧼=⧽ γ(x₃)↙⸤m⸥
      A⁆}
   R⁃ ⊢⸤m⸥ ψ
      -------------------------------------------
      γ ⊢⸤m⸥ δ,x₁ ¿ x₂ ◇ x₃ ↪ δ,‹cond›(i₁,i₂,i₃)⸢ψ⸣@m
   R⁆
P⁃ Rː⦗ST-Pair⦘
   R⁅{Aːrcl
      A⁅ v₁ ⧼=⧽ γ(x₁)↙⸤m⸥
      A⁃ v₂ ⧼=⧽ γ(x₂)↙⸤m⸥
      A⁆}
      -------------------------------------------
      γ ⊢⸤m⸥ δ,⟨x₁,x₂⟩ ↪ δ,⟨v₁,v₂⟩@m
   R⁆
P⁃ Rː⦗ST-Proj⦘
   R⁅ ⟨v₁,v₂⟩@m = γ(x)↙⸤m⸥
      -------------------------------------------
      γ ⊢⸤m⸥ δ,πᵢ␣x ↪ δ,vᵢ
   R⁆
P⁃ Rː⦗ST-Inj⦘
   R⁅ v = γ(x)↙⸤m⸥
      -------------------------------------------
      γ ⊢⸤m⸥ δ,ιᵢ␣x ↪ δ,(ιᵢ␣v)@m
   R⁆
P⁃ Rː⦗ST-Fun⦘
   R⁅ -------------------------------------------
      γ ⊢⸤m⸥ δ,λ⸤z⸥x⍪ e ↪ δ,⟨λ⸤z⸥x⍪ e, γ⟩@m
   R⁆
P⁃ Rː⦗ST-Ref⦘
   R⁅ v = γ(x)↙⸤m⸥
      -------------------------------------------
      γ ⊢⸤m⸥ δ,⦑ref⦒␣x ↪ ❴ℓ↦v❵⊎δ,ℓ⸢⋕m⸣@m
   R⁆
P⁃ Rː⦗ST-Deref⦘
   R⁅ ℓ⸢⋕q⸣@m = γ(x)↙⸤m⸥
   %R⁃ m     ⊆ q
      -------------------------------------------
      γ ⊢⸤m⸥ δ,¡x ↪ δ,δ(ℓ)↙⸤m⸥
   R⁆
P⁃ Rː⦗ST-Assign⦘
   R⁅{Aːrcl
      A⁅ ℓ⸢⋕m⸣@m ⧼=⧽ γ(x₁)↙⸤m⸥
      A⁃ v           ⧼=⧽ γ(x₂)↙⸤m⸥
      A⁆}
      -------------------------------------------
      γ ⊢⸤m⸥ δ,x₁ ≔ x₂ ↪ δ[ℓ↦v],v
   R⁆
P⁃ Rː⦗ST-Read⦘
   R⁅ |m| = 1
      -------------------------------------------
      γ ⊢⸤m⸥ δ,⦑read⦒ ↪ δ,i@m
   R⁆
P⁃ Rː⦗ST-Write⦘
   R⁅ i@m = γ(x)↙⸤m⸥
   R⁃ |m| = 1
      -------------------------------------------
      γ ⊢⸤m⸥ δ,⦑write⦒␣x ↪ δ,0@m
   R⁆
P◘ Rː⦗ST-Share⦘
   R⁅{Aː[b]rcl
      A⁅ p@m   ⧼=⧽ γ(x₁)↙⸤m⸥
      A⁃ q@m   ⧼=⧽ γ(x₂)↙⸤m⸥
      A⁃ i@p  ⧼=⧽ γ(x₃)↙⸤p⸥
      A⁆}
   R⁃{Aː[b]rcl
      A⁅ p     ⧼⊆⧽ q
      A⁃ |p|   ⧼=⧽ 1
      A⁆}
   R⁃{Aː[b]rcl
      A⁅ q ⧼≠⧽ ∅
      A⁃ m ⧼=⧽ p ∪ q
      A⁆}
      -------------------------------------------
      γ ⊢⸤m⸥ δ,⦑share⦒[x₁ → x₂]␣x₃ ↪ δ,i⸢⦑enc⦒⋕q⸣@q
   R⁆
P⁃ Rː⦗ST-Reveal⦘
   R⁅{Aː[b]rcl
      A⁅ p@m          ⧼=⧽ γ(x₁)↙⸤m⸥
      A⁃ q@m          ⧼=⧽ γ(x₂)↙⸤m⸥
      A⁃ i⸢⦑enc⦒⋕p⸣@p ⧼=⧽ γ(x₃)↙⸤p⸥
      A⁆}
   R⁃{Aː[b]rcl
      A⁅ q ⧼≠⧽ ∅
      A⁃ m ⧼=⧽ p ∪ q
      A⁆}
      -------------------------------------------
      γ ⊢⸤m⸥ δ,⦑reveal⦒[x₁ → x₂]␣x₃ ↪ δ,i@q
   R⁆
P⁆
\vspace*{-2ex}
M⁅
X⁅⩊B⁅ ς —→ ς B⁆X⁆
M⁆
\vspace*{-5ex}
P⁅ Rː⦗ST-Case-Inj⦘
   R⁅ (ιᵢ␣v)@m = γ(x₁)↙⸤m⸥
      --------------------------------------
      m,γ,δ,κ,⦑case⦒␣x₁␣❴x₂.e₁❵❴x₂.e₂❵ —→ m,❴x₂↦v❵⊎γ,δ,κ,eᵢ
   R⁆
P⁃ Rː⦗ST-Case-PSet-Emp⦘
   R⁅ ∅@m = γ(x₁)↙⸤m⸥
      --------------------------------------
      m,γ,δ,κ,⦑case⦒␣x₁␣❴.e₁❵❴x₂x₃.e₂❵ —→ m,γ,δ,κ,e₁
   R⁆
P⁃ Rː⦗ST-Case-PSet-Cons⦘
   R⁅ (❴A❵⊎p)@m = γ(x₁)↙⸤m⸥
      --------------------------------------
      m,γ,δ,κ,⦑case⦒␣x₁␣❴.e₁❵❴x₂x₃.e₂❵ —→ m,❴x₂↦❴A❵,x₃↦p❵⊎γ,δ,κ,e₂
   R⁆
P⁃ Rː⦗ST-Par⦘
   R⁅ p@m = γ(x)↙⸤m⸥
   R⁃ m∩p ≠ ∅
      -------------------------------------------
      m,γ,δ,κ,⦑par⦒[x]␣e —→ m∩p,γ,δ,κ,e
   R⁆
P⁃ Rː⦗ST-ParEmpty⦘
   R⁅ p@m = γ(x)↙⸤m⸥
   R⁃ m∩p = ∅
   R⁃ γ′ = ❴x′↦★❵⊎γ
      -------------------------------------------
      m,γ,δ,κ,⦑par⦒[x]␣e —→ m,γ′,δ,κ,x′
   R⁆
P⁃ Rː⦗ST-App⦘
   R⁅ v₁ = γ(x₁)↙⸤m⸥
   R⁃  v₂ = γ(x₂)↙⸤m⸥
   R⁃ ⟨λ⸤z⸥x⍪ e, γ′⟩@m = v₁
      ----------------------------------------
      m,γ,δ,κ,x₁␣x₂ —→ m,❴z↦v₁,x↦v₂❵⊎γ′,δ,κ,e
   R⁆
P⁃ Rː⦗ST-LetPush⦘
   R⁅ κ′ = ⟨⦑let⦒␣x=□␣⦑in⦒␣e₂¦m,γ⟩∷κ
      ------------------------------------------
      m,γ,δ,κ,⦑let⦒␣x=e₁␣⦑in⦒␣e₂ —→ m,γ,δ,κ′,e₁
   R⁆
P⁃ Rː⦗ST-LetPop⦘
   R⁅ γ ⊢⸤m⸥ δ,a ↪ δ′,v
   R⁃ κ = ⟨⦑let⦒␣x=□␣⦑in⦒␣e¦m′,γ′⟩∷κ′
      -------------------------------------
      m,γ,δ,κ,a —→ m′,❴x↦v❵⊎γ′,δ′,κ′,e
   R⁆
P⁆
\vspace*{-2ex}
D⁆
\endgroup
\vspace*{-2ex}
\caption{#2}
\label{#1}
\vspace*{-2ex}
\end{figure*}
}

\newcommand\FigureMPCSemanticsDistributedSubset[2]{
\begin{figure*}
\begingroup
\def\MathparLineskip{\lineskip=2pt}
\setlength\arraycolsep{0pt} % default is 6pt
\small
D⁅
\vspace*{-2ex}
M⁅
X⁅ ⇡.v ∈ ‹lval› ⩴ i⸢ψ⸣ ¦ p ¦ ℓ⸢⋕m⸣
               ¦ ιᵢ␣⇡.v ¦ ⟨⇡.v,⇡.v⟩
               ¦ ⟨λ⸤z⸥x⍪ e, ⇡.γ⟩
               ¦ ★
  ⩊
  ⇡.ς ∈ ‹lconfig›  ⩴ m, ⇡.γ, ⇡.δ, ⇡.κ, e
  ⩊
    C ∈ ‹dconfig›  ≜ ‹party› ⇀ ‹lconfig›
X⁆
M⁆
\hrule
\vspace*{0.5ex}
M⁅
X⁅⩊
   Rː⦗DS-Var⦘
   R⁅ -------------------------------------------
      ⇡.γ ⊢ₘ ⇡.δ,x ↪ ⇡.δ, ⇡.γ(x)
   R⁆
   ⩊
   Rː⦗DS-Int-Binop⦘
   R⁅ i₁⸢ψ⸣ = ⇡.γ(x₁)
   R⁃ i₂⸢ψ⸣ = ⇡.γ(x₂)
   R⁃ ⊢ₘ ψ
      -------------------------------------------
      ⇡.γ ⊢ₘ ⇡.δ,x₁⊙x₂ ↪ ⇡.δ,⟦⊙⟧(i₁,i₂)⸢ψ⸣
   R⁆
   ⩊
   AːcA⁅ B⁅ ⇡.γ ⊢ₘ ⇡.δ,a ↪ ⇡.δ, ⇡.v B⁆ A⁃ ␣ A⁃ ␣ A⁃ ␣ A⁆
X⁆
M⁆
\vspace*{-4ex}
M⁅
X⁅ ⩊
   Rː⦗DS-Par⦘
   R⁅ p = ⇡.γ(x)
   R⁃ A ∈ p
      -------------------------------------------
      m,⇡.γ,⇡.δ,⇡.κ,⦑par⦒[x]␣e —→⸤A⸥ m∩p,⇡.γ,⇡.δ,⇡.κ,e
   R⁆
   ⩊
   Rː⦗DS-ParEmpty⦘
   R⁅ p = ⇡.γ(x)
   R⁃ A ∉ p
   R⁃ ⇡.γ′ = ❴x′↦★❵⊎⇡.γ
      -------------------------------------------
      m,⇡.γ,⇡.δ,⇡.κ,⦑par⦒[x]␣e —→⸤A⸥ m,⇡.γ′,⇡.δ,⇡.κ,x′
   R⁆
   ⩊
   AːcA⁅ B⁅ ⇡.ς —→⸤A⸥ ⇡.ς B⁆ A⁃ ␣ A⁃ ␣ A⁃ ␣ A⁆
X⁆
M⁆
\vspace*{-4ex}
M⁅
X⁅⩊B⁅ C ↝ C B⁆X⁆
M⁆
\vspace*{-5.5ex}
P⁅
Rː⦗DS-Step⦘
   R⁅ ⇡.ς —→⸤A⸥ ⇡.ς′
      ----------------
      ❴A ↦ ⇡.ς ❵ ⊎ C ↝ ❴A ↦ ⇡.ς′ ❵ ⊎ C
   R⁆
P⁃ Rː⦗DS-Share⦘
   R⁅{Aː[b]rcl
     A⁅ ⦑share⦒[x₁ → x₂]␣x₃ ⧼=⧽ C(m).e
      A⁃ p   ⧼=⧽ C(m).⇡.γ(x₁)
      A⁃ q   ⧼=⧽ C(m).⇡.γ(x₂)
      A⁃ i   ⧼=⧽ C(p).⇡.γ(x₃)
      A⁆}
   R⁃{Aː[b]rcl
      A⁅ m     ⧼=⧽ C(m).m
      A⁃ m     ⧼=⧽ p ∪ q
      A⁃ q     ⧼≠⧽ ∅ ␠ |p| = 1
      A⁃ p     ⧼⊆⧽ q
      A⁆}
    R⁃{Aː[b]rcl
       A⁅ C′ = ⧼❴⧽ A ↦ (m,❴x↦⇡.v❵⊎⇡.γ,⇡.δ,⇡.κ,x)
       A⁃      ⧼¦⧽ C(A) = (m,⇡.γ,⇡.δ,⇡.κ,e),
       A⁃      ⧼ ⧽ A ∈ q ⟹ ⇡.v = i⸢⦑enc⦒⋕q⸣,
       A⁃      ⧼ ⧽ A ∈ p ∧ A ∉ q ⟹ ⇡.v = ★ ❵
       A⁆}
      -------------------------------------------
      C⸤0⸥ ⊎ C ↝ C⸤0⸥ ⊎ C′
   R⁆
P⁃ Rː⦗DS-Reveal⦘
   R⁅{Aː[b]rcl
     A⁅ ⦑reveal⦒[x₁ → x₂]␣x₃ ⧼=⧽ C(m).e
      A⁃ p   ⧼=⧽ C(m).⇡.γ(x₁)
      A⁃ q   ⧼=⧽ C(m).⇡.γ(x₂)
      A⁃ i⸢⦑enc⦒⋕p⸣ ⧼=⧽ C(p).⇡.γ(x₃)
      A⁆}
   R⁃{Aː[b]rcl
      A⁅ m ⧼=⧽ C(m).m
      A⁃ q ⧼≠⧽ ∅
      A⁃ m ⧼=⧽ p ∪ q
      A⁆}
    R⁃{Aː[b]rcl
      A⁅ C′ = ⧼❴⧽ A ↦ (m,❴x↦⇡.v❵⊎⇡.γ,⇡.δ,⇡.κ,x)
      A⁃      ⧼¦⧽ C(A) = (m,⇡.γ,⇡.δ,⇡.κ,e),
      A⁃      ⧼ ⧽ A ∈ q ⟹ ⇡.v = i,
      A⁃      ⧼ ⧽ A ∈ p ∧ A ∉ q ⟹ ⇡.v = ★ ❵
      A⁆}
      -------------------------------------------
      C⸤0⸥ ⊎ C ↝ C⸤0⸥ ⊎ C′
   R⁆
P⁆
\vspace*{-4ex}
D⁆
\endgroup
\vspace*{-2ex}
\caption{#2}
\label{#1}
\vspace*{-2ex}
\end{figure*}
}

\newcommand\FigureMPCSemanticsDistributedAux[2]{
\begin{figure*}
\begingroup
\setlength\arraycolsep{0pt} % default is 6pt
\smaller
 D⁅
M⁅X⁅⩊B⁅
       ‗↯⸤A⸥ ∈ ‹loc-value› → ‹lvalue› ␣⨟␣ ‹value› → ‹lvalue›
             ⨟ ‹env› → ‹lenv› ␣⨟␣ ‹store› → ‹lstore› ␣⨟␣ ‹stack› → ‹lstack›
     B⁆X⁆M⁆
M⁅
X⁅⩊Aːrcl
   A⁅ i⸢ψ⸣↯⸤A⸥         ⧼≜⧽ i⸢ψ⸣
   A⁃ p↯⸤A⸥            ⧼≜⧽ p
   A⁃ (ιᵢ␣v)↯⸤A⸥       ⧼≜⧽ ιᵢ␣v↯⸤A⸥
   A⁆
  ⩊Aːrcl
   A⁅ ⟨v₂,v₂⟩↯⸤A⸥      ⧼≜⧽ ⟨v₁↯⸤A⸥,v₂↯⸤B⸥⟩
   A⁃ ⟨λ⸤z⸥x⍪ e,γ⟩↯⸤A⸥ ⧼≜⧽ ⟨λ⸤z⸥x⍪ e,γ↯⸤A⸥⟩
   A⁃ ℓ⸢⋕m⸣↯⸤A⸥         ⧼≜⧽ ℓ⸢⋕m⸣
   A⁆
  ⩊Aːrcl
   A⁅ u@p↯⸤A⸥      ⧼≜⧽ ‘❴Aːl@{␠}l@{␠}l
                         A⁅ u↯⸤A⸥ & «if» & A ∈ p
                         A⁃ ★     & «if» & A ∉ p
                         A⁆’.
   A⁃ ★↯⸤A⸥        ⧼≜⧽ ★
   A⁆
  ⩊Aːrcl
   A⁅ γ↯⸤A⸥(x)     ⧼≜⧽ γ(x)↯⸤A⸥
   A⁃ δ↯⸤A⸥(ℓ)     ⧼≜⧽ δ(ℓ)↯⸤A⸥
   A⁆
  ⩊
X⁃
X⁃⩊ ⊤↯⸤A⸥ ≜ ⊤
  ⩊ (⟨⦑let⦒␣x=□␣⦑in⦒␣e ¦ m,γ⟩ ∷ κ)↯⸤A⸥ ≜ ⟨⦑let⦒␣x=□␣⦑in⦒␣e ¦ γ↯⸤A⸥⟩ ∷ κ↯⸤A⸥
  ⩊
X⁃
X⁃⩊(m,γ,δ,κ,e)↯ ≜ ❴A ↦ m,γ↯⸤A⸥, δ↯⸤A⸥,κ↯⸤A⸥,e ¦ A ∈ m❵
  ⩊B⁅‗↯ ∈ ‹config› → ‹mtconfig› B⁆
X⁆
M⁆
D⁆
\endgroup
  \caption{#2}
  \label{#1}
\end{figure*}
}

\newcommand\FigureOblivSyntax[2]{
\begin{figure*} % {{{ Syntax
\small
M⁅X⁅⩊ Aːrcrcl@{␠}l
      A⁅ ℓ   ⧼∈⧽ ‹label›   ⧼⩴⧽ ‹P› ¦ ‹S›                       & ⟪public and secret⟫
      A⁃     ⧼ ⧽ 𝑚𝑐3c{⟪(«where» ⸨‹P›⊏‹S›⸩)⟫}                   & ⟪security labels⟫
      A⁃ ρ   ⧼∈⧽ R         ⧼⩴⧽ …                               & ⟪probability region⟫
      A⁃ b   ⧼∈⧽ 𝔹         ⧼⩴⧽ ⦑O⦒ ¦ ⦑I⦒                       & ⟪bits⟫
      A⁃ x,y ⧼∈⧽ ‹var›     ⧼⩴⧽ …                               & ⟪variables⟫
      A⁃ v   ⧼∈⧽ ‹val›     ⧼⩴⧽ x                               & ⟪variable values⟫
      A⁃     ⧼ ⧽           ⧼¦⧽ ⦑fun⦒⸤y⸥(x{⦂}τ).e               & ⟪function values⟫
      A⁃     ⧼ ⧽           ⧼¦⧽ ⟨v,v⟩                           & ⟪tuple values⟫
      A⁃ τ   ⧼∈⧽ ‹type›    ⧼⩴⧽ ⦑bit⦒⸤ℓ⸥⸢ρ⸣                     & ⟪non-random bit⟫
      A⁃     ⧼ ⧽           ⧼¦⧽ ⦑flip⦒⸢ρ⸣                       & ⟪secret uniform bit⟫
      A⁃     ⧼ ⧽           ⧼¦⧽ ⦑ref⦒(τ)                        & ⟪reference⟫
      A⁃     ⧼ ⧽           ⧼¦⧽ τ × τ                           & ⟪tuple⟫
      A⁃     ⧼ ⧽           ⧼¦⧽ τ → τ                           & ⟪function⟫
      A⁆
    ⩊ Aːrcl@{␠}l
      A⁅ e ∈ ‹exp›  ⧼⩴⧽ v                       & ⟪value expressions⟫
      A⁃     ⧼¦⧽ b⸤ℓ⸥                            & ⟪bit literal⟫
      A⁃     ⧼¦⧽ ⦑flip⦒⸢ρ⸣()                     & ⟪coin flip in region⟫
      A⁃     ⧼¦⧽ ⦑cast⦒⸤l⸥(v)                    & ⟪cast flip to bit⟫
      A⁃     ⧼¦⧽ e ¿ e ◇ e                       & ⟪atomic conditional⟫
      A⁃     ⧼¦⧽ ⦑xor⦒(e,e)                      & ⟪bit xor⟫
      A⁃     ⧼¦⧽ ⦑if⦒(e)❴e❵❴e❵                   & ⟪branch conditional⟫
      A⁃     ⧼¦⧽ ⦑ref⦒(e)                        & ⟪reference creation⟫
      A⁃     ⧼¦⧽ ⦑read⦒(e)                       & ⟪reference read⟫
      A⁃     ⧼¦⧽ ⦑write⦒(e,e)                    & ⟪reference write⟫
      A⁃     ⧼¦⧽ ⟨e,e⟩                           & ⟪tuple creation⟫
      A⁃     ⧼¦⧽ ⦑let⦒␣x = e␣⦑in⦒␣e              & ⟪variable binding⟫
      A⁃     ⧼¦⧽ ⦑let⦒␣x,y = e␣⦑in⦒␣e            & ⟪tuple elimination⟫
      A⁃     ⧼¦⧽ e(e)                            & ⟪fun. application⟫
      A⁆
    ⩊
  X⁆
M⁆
\caption{#2}
\label{#1}
\end{figure*} % }}}
}

\newcommand\FigureOblivSemantics[2]{
\begin{figure*}  % {{{ Semantics
\small
M⁅X⁅⩊ Aːrcrcl@{␠}l
      A⁅ ι ⧼∈⧽ ‹loc› ⧼≈⧽ ℕ            & ⟪ref locations⟫
      A⁃ v ⧼∈⧽ ‹val› ⧼⩴⧽ …            & ⟪extended…⟫
      A⁃   ⧼ ⧽       ⧼¦⧽ ⦑bitv⦒⸤ℓ⸥(b) & ⟪bit value⟫
      A⁃   ⧼ ⧽       ⧼¦⧽ ⦑flipv⦒(b)   & ⟪uniform bit value⟫
      A⁃   ⧼ ⧽       ⧼¦⧽ ⦑locv⦒(ι)    & ⟪location value⟫
      A⁆
    ⩊ Aːrcrcl@{␠}l
      A⁅ σ ⧼∈⧽ ‹store›   ⧼≜⧽ ‹loc› ⇀ ‹val› & ⟪store⟫
      A⁃ e ⧼∈⧽ ‹exp›     ⧼⩴⧽ …             & ⟪extended…⟫
      A⁃ ς ⧼∈⧽ ‹config›  ⧼⩴⧽ σ,e           & ⟪configuration⟫
      A⁃ t ⧼∈⧽ ‹trace›   ⧼⩴⧽ ε ¦ t⋅ς     & ⟪trace⟫
      A⁃ E ⧼∈⧽ ‹context› ⧼⩴⧽ …             & ⟪eval contexts…⟫
      A⁆
    ⩊
  X‣
  X⁃⩊ B⁅ ‹step› ∈ ℕ × ‹config› ⇀ 𝒟 (‹config›) B⁆
  X‣
  X⁃ Aːlcl
     A⁅ ‹step›(N,σ,b⸤ℓ⸥)
        ⧼=⧽ ‹return›(σ,⦑bitv⦒⸤ℓ⸥(b))
     A⁃ ‹step›(N,σ,⦑flip⦒⸢ρ⸣())
        ⧼=⧽ ‹do›␣ b ← ‹bit› ⨟ ‹return›(σ,⦑flipv⦒(b))
     A⁃ ‹step›(N,σ,⦑cast⦒⸤ℓ⸥(⦑flipv⦒(b)))
        ⧼=⧽ ‹return›(σ,⦑bitv⦒⸤ℓ⸥(b))
     A⁃ ‹step›(N,σ,⦑bitv⦒⸤ℓ₁⸥(b₁) ¿ ⦑bitv⦒⸤ℓ₂⸥(b₂) ◇ ⦑bitv⦒⸤ℓ₃⸥(b₃))
        ⧼=⧽ ‹return›(σ,⟨⦑bitv⦒⸤ℓ⸥(‹cond›(b₁,b₂,b₃)),⦑bitv⦒⸤ℓ⸥(‹cond›(b₁,b₃,b₂))⟩)
     A⁃ ⧼ ⧽ ␠⟪«where»⟫ ␠ ℓ ≜ ℓ₁⊔ℓ₂⊔ℓ₃
     A⁃ ‹step›(N,σ,⦑bitv⦒⸤ℓ⸥(b₁) ¿ ⦑flipv⦒(b₂) ◇ ⦑flipv⦒(b₃))
        ⧼=⧽ ‹return›(σ,⟨⦑flipv⦒(‹cond›(b₁,b₂,b₃)),⦑flipv⦒(‹cond›(b₁,b₃,b₂))⟩)
     A⁃ ‹step›(N,σ,⦑if⦒(⦑bitv⦒⸤ℓ⸥(b))❴e₁❵❴e₂❵)
        ⧼=⧽ ‹return›(σ,‹cond›(b,e₁,e₂))
     A⁃ ‹step›(N,σ,⦑xor⦒(⦑bitv⦒⸤ℓ⸥(b₁),⦑flipv⦒(b₂)))
        ⧼=⧽ ‹return›(σ,⦑flipv⦒(b₁⊕b₂))
     A⁃ ‹step›(N,σ,⦑ref⦒(v))
        ⧼=⧽ ‹return›(σ[ι↦v],⦑refv⦒(ι)) ␠ ⟪«where ⸨ι ∉ ‹dom›(σ)⸩»⟫
     A⁃ ‹step›(N,σ,⦑read⦒(⦑refv⦒(ι)))
        ⧼=⧽ ‹return›(σ,σ(ι))
     A⁃ ‹step›(N,σ,⦑write⦒(⦑refv⦒(ι),v))
        ⧼=⧽ ‹return›(σ[ι↦v],σ(ι))
     A⁃ ‹step›(N,σ,⦑let⦒␣x = v␣⦑in⦒␣e)
        ⧼=⧽ ‹return›(σ,[v/x]e)
     A⁃ ‹step›(N,σ,⦑let⦒␣x₁,x₂ = ⟨v₁,v₂⟩␣⦑in⦒␣e)
        ⧼=⧽ ‹return›(σ,[v₁/x₁][v₂/x₂]e)
     A⁃ ‹step›(N,σ,(⇣v*{v₁}{⦑fun⦒⸤y⸥(x⦂τ)⍪e})(v₂))
        ⧼=⧽ ‹return›(σ,[v₁/y][v₂/x]e)
     A‣ ‹step›(N,σ,E[e])
        ⧼=⧽ ‹do›␣ σ′,e′ ← ‹step›(N,σ,e) ⨟ ‹return›(σ′,E[e′])
     A⁃ ‹step›(N,σ,v)
        ⧼=⧽ ‹return›(σ,v)
     A⁆
  X‣
  X⁃⩊ B⁅ ‹nstep› ∈ ℕ × ‹config› ⇀ 𝒟(‹trace›) B⁆
  X⁃ Aːlcl
     A⁅ ‹nstep›(0,ς)   ⧼=⧽ ‹return›(ε⋅ς)
     A⁃ ‹nstep›(N+1,ς) ⧼=⧽ ‹do›␣t⋅ς′ ← ‹nstep›(N,ς) ⨟ ς″ ← ‹step›(N+1,ς′) ⨟ ‹return›(t⋅ς′⋅ς″)
     A⁆
  X‣
  X⁃⩊  ⇡~x ∈ 𝒟(A) ≜ ‘❴ f ∈ A → ℝ ⫾ ∑⸤x∈A⸥ f(x) = 1 ’❵
    ⩊  ‹Pr›‘[⇡~x ⩦ x ’] ≜ ⇡~x(x)
    ⩊ B⁅ 𝒟(A) ∈ ‹set› B⁆
    ⩊
  X‣
  X⁃Aːl@{␠}l@{␠}l
    A⁅ ‹return› ∈ 𝒟(A) & ‹bind› ∈ 𝒟(A) × (A → 𝒟(B)) → 𝒟(B) & ‹bit› ∈ 𝒟(𝔹)
    A⁃ ‹return›(x) ≜ λx′⍪ ‘❴Aːl@{␠}c@{␠}l
                           A⁅ 1 ⧼⟪«if»⟫⧽ x = x′
                           A⁃ 0 ⧼⟪«if»⟫⧽ x ≠ x′
                           A⁆’.
     & ‹bind›(⇡~x,f) ≜ λy⍪ ∑⸤x⸥f(x)(y)⇡~x(x)
     & ‹bit› ≜ λb⍪ ½
    A⁆
  X⁆
M⁆
\caption{#2}
\label{#1}
\end{figure*} % }}}
}

\newcommand\FigureOblivTypes[2]{
\begin{figure*} % {{{ Type System
\small
M⁅
X⁅⩊ Aːrcrcl@{␠}l
    A⁅ ⇡•τ ⧼∈⧽ ‹t⇡•{yp}e› ⧼⩴⧽ τ   ¦ •  ␣␣⟪(«where» ⸨τ ⊏ •⸩)⟫
    A⁃ κ   ⧼∈⧽ ‹kind›     ⧼⩴⧽ ⦑U⦒ ¦ ⦑A⦒␣␣⟪(«where» ⸨⦑U⦒⊏⦑A⦒⸩)⟫
    A⁆
  ⩊
  ⩊ Aːc
    A⁅ Γ ∈ ‹tcxt› ≜ var ⇀ ‹t⇡•{yp}e›
    A⁃ (Γ₁⊔Γ₂)(x)≜Γ₁(x)⊔Γ₂(x)
    A⁆
  ⩊
X‣
X⁃⩊ B⁅ 𝒦 ∈ ‹type›\!→\!‹kind› B⁆
X‣
X⁃⩊ 𝒦(⦑bit⦒⸤ℓ⸥⸢ρ⸣) ≜ 𝒦(τ₁\!→\!τ₂) ≜ 𝒦(⦑ref⦒(τ)) ≜ ⦑U⦒
  ⩊ 𝒦(⦑flip⦒⸢ρ⸣) ≜ ⦑A⦒
  ⩊ 𝒦(τ₁{×}τ₂) ≜ 𝒦(τ₁){⊔}𝒦(τ₂)
X‣
X⁃⩊ B⁅ Γ ⊢ e ⦂ τ ⨟ ΓB⁆
\\[-4ex]
⁅⁅\def\MathparLineskip{\lineskip=4pt}
P⁅ Rː⦗VarU⦘
   R⁅{Aːrcl
      A⁅𝒦(Γ(x)) ⧼=⧽ ⦑U⦒
      A⁃Γ(x)    ⧼=⧽ τ
      A⁆}
      ------------------------
      Γ ⊢ x ⦂ τ ⨟ Γ
   R⁆
P⁃ Rː⦗VarA⦘
   R⁅{Aːrcl
      A⁅ 𝒦(Γ(x)) ⧼=⧽ ⦑A⦒
      A⁃ Γ(x)    ⧼=⧽ τ
      A⁆}
      -----------------------------
      Γ ⊢ x ⦂ τ ⨟ Γ[x{↦}•]
   R⁆
P⁃ Rː⦗Bit⦘
   R⁅ ------------------------------
      Γ ⊢ b⸤ℓ⸥ ⦂ ⦑bit⦒⸤ℓ⸥⸢⊥⸣ ⨟ Γ
   R⁆
P⁃ Rː⦗Flip⦘
   R⁅
      -----------------------------------------------------------
      Γ ⊢ ⦑flip⦒⸢ρ⸣() ⦂ ⦑flip⦒⸢ρ⸣ ⨟ Γ
   R⁆
P⁃ Rː⦗Cast-S⦘
   R⁅ Γ ⊢ x ⦂ ⦑flip⦒⸢ρ⸣ ⨟ ‗
      -----------------------------------
      Γ ⊢ ⦑cast⦒⸤‹S›⸥(x) ⦂ ⦑bit⦒⸤‹S›⸥⸢ρ⸣ ⨟ Γ
   R⁆
P⁃ Rː⦗Cast-P⦘
   R⁅ Γ ⊢ x ⦂ ⦑flip⦒⸢ρ⸣ ⨟ Γ′
      -------------------------------------
      Γ ⊢ ⦑cast⦒⸤‹P›⸥(x) ⦂ ⦑bit⦒⸤‹P›⸥⸢⊥⸣ ⨟ Γ′
   R⁆
P⁃ Rː⦗If⦘
   R⁅{Aːc@{␣␣}rcl
      A⁅                             & Γ′ ⧼⊢⧽ e₁ ⦂ τ ⨟ Γ″₁
      A⁃ Γ  ⊢ e ⦂ ⦑bit⦒⸤‹P›⸥⸢⊥⸣ ⨟ Γ′ & Γ′ ⧼⊢⧽ e₂ ⦂ τ ⨟ Γ″₂
      A⁆}
      ------------------------------------------------------------
      Γ ⊢ ⦑if⦒(e)❴e₁❵❴e₂❵ ⦂ τ ⨟ Γ″₁ ⊔ Γ″₂
   R⁆
P⁃ Rː⦗Mux-Bit⦘
   R⁅{Aːrcl@{␣␣}rcl
      A⁅ Γ  ⧼⊢⧽ e₁ ⦂ ⦑bit⦒⸤ℓ₁⸥⸢ρ₁⸣ ⨟ Γ′ &
      A⁃ Γ′ ⧼⊢⧽ e₂ ⦂ ⦑bit⦒⸤ℓ₂⸥⸢ρ₂⸣ ⨟ Γ″ & ℓ ⧼=⧽ ℓ₁\!⊔\!ℓ₂\!⊔\!ℓ₃
      A⁃ Γ″ ⧼⊢⧽ e₃ ⦂ ⦑bit⦒⸤ℓ₃⸥⸢ρ₃⸣ ⨟ Γ‴ & ρ ⧼=⧽ ρ₁\!⊔\!ρ₂\!⊔\!ρ₃
      A⁆}
      ---------------------------------------------------------------------------------
      Γ ⊢ e₁ ¿ e₂ ◇ e₃ ⦂ ⦑bit⦒⸤ℓ⸥⸢ρ⸣\!×\!⦑bit⦒⸤ℓ⸥⸢ρ⸣ ⨟ Γ‴
   R⁆
P⁃ Rː⦗Mux-Flip⦘
   R⁅{Aːrcl@{␣␣}rcl
      A⁅ Γ  ⧼⊢⧽ e₁ ⦂ ⦑bit⦒⸤ℓ₁⸥⸢ρ₁⸣ ⨟ Γ′ & ρ₁ ⧼⊏⧽ ρ₂
      A⁃ Γ′ ⧼⊢⧽ e₂ ⦂ ⦑flip⦒⸢ρ₂⸣ ⨟ Γ″    & ρ₁ ⧼⊏⧽ ρ₃
      A⁃ Γ″ ⧼⊢⧽ e₃ ⦂ ⦑flip⦒⸢ρ₃⸣ ⨟ Γ‴    & 𝑚𝑐3c{ρ = ρ₁\!⊔ρ₂\!⊔\!ρ₃}
      A⁆}
      ---------------------------------------------------------------------------------
      Γ ⊢ e₁ ¿ e₂ ◇ e₃ ⦂ ⦑flip⦒⸢ρ⸣\! ×\! ⦑flip⦒⸢ρ⸣ ⨟ Γ‴
   R⁆
P⁃ Rː⦗Xor-Flip⦘
   R⁅{Aːrcl@{␣␣}c
      A⁅ Γ  ⧼⊢⧽ e₁ ⦂ ⦑bit⦒⸤ℓ₁⸥⸢ρ₁⸣ ⨟ Γ′ &
      A⁃ Γ′ ⧼⊢⧽ e₂ ⦂ ⦑flip⦒⸢ρ₂⸣    ⨟ Γ″ & ρ₁ ⊏ ρ₂
      A⁆}
      ------------------------------
      Γ ⊢ ⦑xor⦒(e₁,e₂) ⦂ ⦑flip⦒⸢ρ₂⸣ ⨟ Γ″
   R⁆
P⁃ Rː⦗Ref⦘
   R⁅ Γ ⊢ e ⦂ τ ⨟ Γ′
      ------------------------
      Γ ⊢ ⦑ref⦒(e) ⦂ ⦑ref⦒(τ) ⨟ Γ′
   R⁆
P⁃ Rː⦗Read⦘
   R⁅ 𝒦(τ) = ⦑U⦒
   R◘ Γ ⊢ e ⦂ ⦑ref⦒(τ) ⨟ Γ′
      ------------------------
      Γ ⊢ ⦑read⦒(e) ⦂ τ ⨟ Γ′
   R⁆
P⁃ Rː⦗Write⦘
   R⁅ Γ  ⊢ e₁ ⦂ ⦑ref⦒(τ) ⨟ Γ′
   R⁃ Γ′ ⊢ e₂ ⦂ τ ⨟ Γ″
      ------------------------
      Γ ⊢ ⦑write⦒(e₁,e₂) ⦂ τ ⨟ Γ″
   R⁆
P⁃ Rː⦗Tup⦘
   R⁅ Γ  ⊢ e₁ ⦂ τ₁ ⨟ Γ′
   R⁃ Γ′ ⊢ e₂ ⦂ τ₂ ⨟ Γ″
      ------------------------------------
      Γ ⊢ ⟨e₁,e₂⟩ ⦂ τ₁ × τ₂ ⨟ Γ″
   R⁆
P⁃ Rː⦗Fun⦘
   R⁅{Aːrcl@{␣␣}rcl
      A⁅    ⧼ ⧽              & Γ⁺ ⧼=⧽ Γ⊎[x {↦} τ₁,y {↦} (τ₁ {→} τ₂)]
      A⁃ Γ⁺ ⧼⊢⧽ e ⦂ τ₂ ⨟ Γ⁺′ & Γ⁺′⧼=⧽ Γ⊎[x {↦} ‗,y {↦} ‗]
      A⁆}
      ------------------------------------------------------------
      Γ ⊢ ⦑fun⦒⸤y⸥(x⦂τ₁)⍪ e ⦂ τ₁ → τ₂ ⨟ Γ
   R⁆
P⁃ Rː⦗App⦘
   R⁅{Aːrcl
      A⁅ Γ  ⧼⊢⧽ e₁ ⦂ τ₁ → τ₂ ⨟ Γ′
      A⁃ Γ′ ⧼⊢⧽ e₂ ⦂ τ₁      ⨟ Γ″
      A⁆}
      ------------------------------
      Γ  ⊢ e₁(e₂) ⦂ τ₂ ⨟ Γ″
   R⁆
P⁃ Rː⦗Let⦘
   R⁅{Aːrcl@{␣␣}rcl
      A⁅ Γ   ⧼⊢⧽ e₁ ⦂ τ₁ ⨟ Γ′  & Γ′⁺ ⧼=⧽ Γ′⊎[x{↦}τ₁]
      A⁃ Γ′⁺ ⧼⊢⧽ e₂ ⦂ τ₂ ⨟ Γ″⁺ & Γ″⁺ ⧼=⧽ Γ″⊎[x{↦}‗ ]
      A⁆}
      -------------------------------------------
      Γ ⊢ ⦑let⦒␣x = e₁␣⦑in⦒␣e₂ ⦂ τ₂ ⨟ Γ″
   R⁆
P⁃ Rː⦗Let-Tup⦘
   R⁅{Aːrcl@{␣␣}rcl
      A⁅ Γ   ⧼⊢⧽ e₁ ⦂ τ₁ × τ₂ ⨟ Γ′ & Γ′⁺ ⧼=⧽ Γ′⊎[x₁{↦}τ₁,x₂{↦}τ₂]
      A⁃ Γ′⁺ ⧼⊢⧽ e₂ ⦂ τ₃ ⨟ Γ″⁺     & Γ″⁺ ⧼=⧽ Γ″⊎[x₁{↦}‗ ,x₂{↦}‗ ]
      A⁆}
      -------------------------------------------
      Γ ⊢ ⦑let⦒␣x₁,x₂ = e₁ ␣⦑in⦒␣ e₂ ⦂ τ₃ ⨟ Γ″
   R⁆
P⁆
⁆⁆
X⁆
M⁆
\caption{#2}
\label{#1}
\end{figure*} % }}}
}


\newcommand\FigureOblivObs[2]{
\begin{figure*} % {{{ Adversary
  \small
M⁅X⁅⩊ Aːrcrcl
      A⁅ ⇡•v ⧼∈⧽ ‹v⇡•alue›  ⧼⩴⧽ … ¦ •
      A⁃ ⇡•e ⧼∈⧽ ‹e⇡•xp›    ⧼⩴⧽ … ¦ •
      A⁆
    ⩊ Aːrcrcl
      A⁅ ⇡•σ ⧼∈⧽ ‹st⇡•ore›  ⧼≜⧽  ‹loc› ⇀ ‹v⇡•alue›
      A⁃ ⇡•ς ⧼∈⧽ ‹co⇡•nfig› ⧼⩴ ⧽  ⇡•σ,⇡•e
      A⁆
    ⩊ ⇡•t∈‹tr⇡•ace›  ⩴ ε ¦ ⇡•t⋅⇡•ς
    ⩊
  X‣
  X⁃⩊ B⁅ ‹obs› ∈ (‹exp› → ‹e⇡•xp›) × (‹store› → ‹st⇡•ore›) × (‹config› → ‹co⇡•nfig›) × (‹trace› → ‹tr⇡•ace›) B⁆
  X‣
  X⁃⩊ Aːlcl
      A⁅ ‹obs›(x)                    ⧼≜⧽ x
      A⁃ ‹obs›(⦑fun⦒⸤y⸥(x⦂τ)⍪e)      ⧼≜⧽ ⦑fun⦒⸤y⸥(x⦂τ)⍪‹obs›(e)
      A⁃ ‹obs›(⦑bitv⦒⸤P⸥(b))         ⧼≜⧽ ⦑bitv⦒⸤P⸥(b)
      A⁃ ‹obs›(⦑bitv⦒⸤S⸥(b))         ⧼≜⧽ •
      A⁃ ‹obs›(⦑flipv⦒(b))           ⧼≜⧽ •
      A⁃ ‹obs›(⦑locv⦒(ι))            ⧼≜⧽ •
      A⁃ ‹obs›(b⸤P⸥)                 ⧼≜⧽ b⸤P⸥
      A⁃ ‹obs›(b⸤S⸥)                 ⧼≜⧽ •
      A⁃ ‹obs›(⦑flip⦒⸢ρ⸣())          ⧼≜⧽ ⦑flip⦒⸢ρ⸣()
      A⁃ ‹obs›(⦑cast⦒⸤ℓ⸥(v))         ⧼≜⧽ ⦑cast⦒⸤ℓ⸥(‹obs›(v))
      A⁆
    ⩊ Aːlcl
      A⁅
      A⁃ ‹obs›(e₁ ¿ e₂ ◇ e₃)         ⧼≜⧽ ‹obs›(e₁) ¿ ‹obs›(e₂) ◇ ‹obs›(e₃)
      A⁃ ‹obs›(⦑xor⦒(e₁,e₂))         ⧼≜⧽ ⦑xor⦒(‹obs›(e₁),‹obs›(e₂))
      A⁃ ‹obs›(⦑if⦒(e₁)❴e₂❵❴e₃❵)     ⧼≜⧽ ⦑if⦒(‹obs›(e₁))❴‹obs›(e₂)❵❴‹obs›(e₃)❵
      A⁃ ‹obs›(⦑ref⦒(e))             ⧼≜⧽ ⦑ref⦒(‹obs›(e))
      A⁃ ‹obs›(⦑read⦒(e))            ⧼≜⧽ ⦑read⦒(‹obs›(e))
      A⁃ ‹obs›(⦑write⦒(e₁,e₂))       ⧼≜⧽ ⦑write⦒(‹obs›(e₁),‹obs›(e₂))
      A⁃ ‹obs›(⟨e₁,e₂⟩)              ⧼≜⧽ ⟨‹obs›(e₁),‹obs›(e₂)⟩
      A⁃ ‹obs›(⦑let⦒␣x=e₁␣⦑in⦒␣e₂)   ⧼≜⧽ ⦑let⦒␣x=‹obs›(e₁)␣⦑in⦒␣‹obs›(e₂)
      A⁃ ‹obs›(⦑let⦒␣x,y=e₁␣⦑in⦒␣e₂) ⧼≜⧽ ⦑let⦒␣x,y=‹obs›(e₁)␣⦑in⦒␣‹obs›(e₂)
      A⁃ ‹obs›(e₁(e₂))               ⧼≜⧽ ‹obs›(e₁)(‹obs›(e₂))
      A⁆
    ⩊
  X‣
  X⁃ ⩊  Aːrcl
        A⁅ ‹obs›(σ) ⧼≜⧽ ❴ι␣{↦}␣‹obs›(v) ¦ ι␣{↦}␣v␣{∈}␣σ❵
        A⁃ ‹obs›(σ,e) ⧼≜⧽ ‹obs›(σ),‹obs›(e)
        A⁆
     ⩊  Aːrcl
        A⁅ ‹obs›(ε) ⧼≜⧽ ε
        A⁃ ‹obs›(t⋅ς) ⧼≜⧽ ‹obs›(t)⋅‹obs›(ς)
        A⁆
     ⩊
  X‣
  X⁃ ⩊ ⇡~*‹obs›(⇡~t) ≜ ‹do›␣t←⇡~t ⨟ ‹return›(‹obs›(t))
     ⩊ B⁅ ⇡~*‹obs› ∈ 𝒟(‹trace›) → 𝒟(‹tr⇡•ace›) B⁆
  X⁆
M⁆
\caption{#2}
\label{#1}
\end{figure*} % }}}
}


\newcommand\FigureLangSyntax[2]{
\begin{figure*} % {{{ Adversary
\small
D⁅
M⁅
Aːrcrcl@{␠}l
A⁅ b     ⧼∈⧽ 𝔹            ⧼ ⧽                                & ⟪booleans⟫
A⁃ i     ⧼∈⧽ ℤ            ⧼ ⧽                                & ⟪integers⟫
A⁃ A,B,C ⧼∈⧽ ‹party›      ⧼ ⧽                                & ⟪parties⟫
A⁃ m,p,q ⧼∈⧽ ‹party-set›  ⧼≜⧽ ℘(‹party›) ⩴ ❴A,…,A❵          & ⟪sets of parties⟫
A⁃ ρ     ⧼∈⧽ R            ⧼ ⧽                                & ⟪probability region⟫
A⁃ φ     ⧼∈⧽ ‹prob›       ⧼⩴⧽ ⦑\faThumbsDown⦒               & ⟪non-uniform⟫
A⁃       ⧼ ⧽              ⧼¦⧽  ⦑\faThumbsUp⦒                 & ⟪uniform⟫
A⁃ ψ     ⧼∈⧽ ‹prot›       ⧼⩴⧽ ⋅                             & ⟪cleartext⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑enc⦒⋕m                        & ⟪encrypted⟫
A⁃ μ     ⧼∈⧽ ‹base-type›  ⧼⩴⧽ ⦑int⦒                         & ⟪integer type⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑bool⦒                         & ⟪boolean type⟫
A⁃ σ     ⧼∈⧽ ‹loc-type›   ⧼⩴⧽ μ⸢φ ; ρ ; ψ⸣                  & ⟪protocol type⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑prins⦒                        & ⟪principal set type⟫
A⁃       ⧼ ⧽              ⧼¦⧽ τ + τ                          & ⟪sum type⟫
A⁃       ⧼ ⧽              ⧼¦⧽ τ × τ                          & ⟪pair type⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑ref⦒ τ                        & ⟪reference type⟫
A⁃       ⧼ ⧽              ⧼¦⧽ τ ᵐ→ τ                         & ⟪function type⟫
A⁃ τ     ⧼∈⧽ ‹type›       ⧼⩴⧽ σ@m                           & ⟪located type⟫
A⁃ x,y,z ⧼∈⧽ ‹var›        ⧼ ⧽                                & ⟪variables⟫
A⁃ ⊙     ⧼∈⧽ ‹binop›      ⧼ ⧽                                & ⟪binary operations (e.g., plus, times)⟫
A⁃ e     ⧼∈⧽ ‹expr›       ⧼⩴⧽ x                             & ⟪variable reference⟫
A⁃       ⧼ ⧽              ⧼¦⧽ i                              & ⟪integer literal⟫
A⁃       ⧼ ⧽              ⧼¦⧽ b                              & ⟪boolean literal⟫
A⁃       ⧼ ⧽              ⧼¦⧽ p                              & ⟪party set literal⟫
A⁃       ⧼ ⧽              ⧼¦⧽ e ⊙ e                          & ⟪binary operation⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑if⦒␣e␣⦑then⦒␣e␣⦑else⦒␣e       & ⟪branch conditional⟫
A⁃       ⧼ ⧽              ⧼¦⧽ e ¿ e ◇ e                      & ⟪atomic conditional⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ιᵢ␣e                           & ⟪sum injection⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑case⦒␣e␣❴⇡-x.e❵❴⇡-x.e❵        & ⟪elim for sums, psets⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⟨e,e⟩                          & ⟪pair creation⟫
A⁃       ⧼ ⧽              ⧼¦⧽ πᵢ␣e                           & ⟪pair projection⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑ref⦒␣x                        & ⟪reference creation⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ¡x                             & ⟪dereference⟫
A⁃       ⧼ ⧽              ⧼¦⧽ x ≔ x                          & ⟪reference assignment⟫
A⁃       ⧼ ⧽              ⧼¦⧽ λ⸤z⸥(x:τ)⍪ e                   & ⟪(recursive) function creation⟫
A⁃       ⧼ ⧽              ⧼¦⧽ e␣e                            & ⟪function elimination⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑let⦒␣x=e␣⦑in⦒␣e               & ⟪let binding⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑par⦒[e]␣e                     & ⟪parallel execution⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑read⦒␣μ                       & ⟪read int input⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑write⦒␣e                      & ⟪write output⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑share⦒[e→e]␣e                 & ⟪share encrypted value⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑reveal⦒⸤b⸥[e→e]␣e             & ⟪reveal encrypted value⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑unif⦒⸢ρ⸣␣μ                    & ⟪uniform, random sample in region⟫
A⁃       ⧼ ⧽              ⧼¦⧽ ⦑observe⦒␣e                    & ⟪cast distribution to base value⟫
A⁆
M⁆
D⁆
\caption{#2}
\label{#1}
\end{figure*}
}
